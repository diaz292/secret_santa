---
output:
  html_document: default
params:
    year: 2019
    limit: 15
    run_matches: yes
title: "Diaz, Guzman, & Co. Secret Santa `r params$year`"
author: "David A. Diaz"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
					  message = FALSE,
					  warning = FALSE)

library(tidyverse)
library(lubridate)
library(scales)
library(readxl)
library(knitr)
library(kableExtra)
library(here)

```

# Introduction

Hello and welcome familia Diaz/Guzman (+ all others)! We are excited to continue our Secret Santa tradition for `r params$year`. Let"s go over some quick guidelines and then delve in!

* As always, everyone is randomly matched to another human (or to a Cindy, a dog, or a cat).
* Your mission is to buy a thoughtful gift for your Secret Santa to be given at our Christmas celebration on **December 24th at midnight**.
* The dollar limit for this year's big event is **$`r params$limit`**. 

```{r fami-pic, fig.align="center", out.width="80%"}

knitr::include_graphics(here::here("figs", paste0(params$year, ".png")))

```

# The Participants

```{r participants}

# read in list of names
fam <- 
  readr::read_csv(here::here("data", "xmas_list.csv")) %>% 
  dplyr::arrange(name)

# display participants
fam %>% 
  dplyr::select(name, dplyr::everything()) %>%
  dplyr::rename(Participant = name) %>%
  knitr::kable(align="l", col.names = NULL) %>% 
  kableExtra::kable_styling(bootstrap_options = "striped") 

```

# The Matches

```{r matches}

if(tolower(params$run_matches) == "yes"){

set.seed(params$year + 7)

fam <- 
  fam %>% 
  dplyr::mutate(name = sample(name)) %>%     
  dplyr::mutate(partner = dplyr::lag(name))  
       
fam$partner[1] <- fam$name[nrow(fam)]  

fam %>% 
  dplyr::arrange(name) %>% 
  knitr::kable(align="l") %>% 
  kableExtra::kable_styling(bootstrap_options = "striped")

} else if(tolower(params$run_matches) == "no"){

  print("To be determined...")

}

```



